---
import { getCollection } from 'astro:content';
import Pattern from '../components/Pattern.astro';
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro'

export async function getStaticPaths() {
  const articles = await getCollection('articles');
  // pubDateでソート
  const sortedArticles = articles.sort((a, b) => {
    return new Date(b.data.pubDate).getTime() - new Date(a.data.pubDate).getTime();
  });
  
  return sortedArticles.map((article, index) => ({
    params: { id: article.id.replace('.md', '') },
    props: {
      article,
      prevArticle: sortedArticles[index - 1],
      nextArticle: sortedArticles[index + 1],
    },
  }));
}

const { article, prevArticle, nextArticle } = Astro.props;
---

<Layout title={article.data.title}>
  <Header />
  <Pattern
    article={article}
    prevArticle={prevArticle}
    nextArticle={nextArticle}
  />
</Layout> 